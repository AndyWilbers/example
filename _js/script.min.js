String.prototype.count=function(t){var a=this.match(new RegExp(t.toString().replace(/(?=[.\\+*?[^\]$(){}\|])/g,"\\"),"g"));return a?a.length:0},String.prototype.repeat=function(t){return new Array(parseInt(t)+1).join(this)},String.prototype.trim||(String.prototype.trim=function(){var t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return this.replace(t,"")}),Array.prototype.indexOf||(Array.prototype.indexOfq=function(t,a){var e;if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),n=o.length>>>0;if(0===n)return-1;var r=+a||0;if(1/0===Math.abs(r)&&(r=0),r>=n)return-1;for(e=Math.max(r>=0?r:n-Math.abs(r),0);n>e;){if(e in o&&o[e]===t)return e;e++}return-1}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Number.prototype.addZeros=function(t){for(var a=this+"";a.length<t;)s="0"+a;return s},window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=window.console.log),window.console.error||(window.console.error=window.console.log),window.console.info||(window.console.info=window.console.log),history.pushParameter=function(t,a,e,o){var n=location.search.trim();if(n.length<1)return void history.pushState(t,a.trim(),"?"+e.trim()+"="+o.trim());var r=n.replace("?","&").indexOf("&"+e.trim()+"=",0);if(0>r)return void history.pushState(t,a.trim(),n+"&"+e.trim()+"="+o.trim());var i=n.indexOf("&",r+1);return 0>i?void history.pushState(t,a.trim(),n.substring(0,r+1)+e.trim()+"="+o.trim()):void history.pushState(t,a.trim(),n.substring(0,r+1)+e.trim()+"="+o.trim()+n.substring(i,n.length-1))};var gen={runFunction:function(t){for(var a=window,e=Array.prototype.slice.call(arguments,1),o=t.split("."),n=o.pop(),r=0;r<o.length;r++)a=a[o[r]];return a[n].apply(a,e)},isSet:function(t){return"undefined"!=typeof t?!0:!1},setDefault:function(t,a){return"undefined"!=typeof t?t:a},sup:{historyState:function(){var t="Browser doesn't support history management.";return history.pushState&&void 0!=window.onpopstate?!0:(window.console.log(t),!1)}},setUrlParameter:function(t,a,e){var t=t.trim(),o=t.indexOf("?",0),n=t.indexOf("#",0);if(0>o&&0>n)return t+"?"+a.trim()+"="+e.trim();var r="";if(n>0){var i=t.split("#");t=i[0],r="#"+i[1]}if(0>o)return t+"?"+a.trim()+"="+e.trim()+r;var s=t.replace("?","&").indexOf("&"+a.trim()+"=",0);if(0>s)return t+"&"+a.trim()+"="+e.trim()+r;var l=t.indexOf("&",s+1);return 0>l?t.substring(0,s+1)+a.trim()+"="+e.trim()+r:t.substring(0,s+1)+a.trim()+"="+e.trim()+t.substring(l,t.length-1)+r},getUrlParameter:function(t,a,e){var o=t.trim();o=o.replace("?","&"),o=o.replace("#","&");var n="&"+a.trim()+"=",r=o.indexOf(n,0);if(0>r)return gen.isSet(e)?e:!1;var i=r+n.length,s=o.indexOf("&",i);return 0>s?o.substring(i).trim():o.substring(i,s).trim()},deleteUrlParameter:function(t,a){var t=t.trim(),e=t.replace("?","&");e=e.replace("#","&");var o="&"+a.trim()+"=",n=e.indexOf(o,0);if(0>n)return t;var r=(n+o.length,e.indexOf("&",n+1)),i=t.substring(0,n).trim();return r>0&&(i+=t.substring(r).trim()),i},timestamp:function(){var t=new Date;return t.getHours()+":"+t.getMinutes()},preventDefault:function(t){t.preventDefault()},dataLog:function(t){window.console.log(JSON.stringify(t))},dataAlert:function(t){alert(JSON.stringify(t))},find_max_val:function(t){var a=null;return 0==$(t).size()?null:($(t).each(function(){if(null===a)a=parseInt($(this).val(),10);else{var t=parseInt($(this).val(),10);a=t>a?t:a}}),a)},find_min_val:function(t){var a=null;return 0==$(t).size()?null:($(t).each(function(){if(null===a)a=parseInt($(this).val(),10);else{var t=parseInt($(this).val(),10);a=a>t?t:a}}),a)},ajax:function(t){return this.p={root:gen.setDefault(t.trim()+"/","")},this.get=function(t){t.data.hasOwnProperty("me")&&delete t.data.me,t.data.url=t.url;var a={data:gen.setDefault(t.data,{}),callback:gen.setDefault(t.callback,"#DEFAULT#")};$.ajax({url:"front.php",type:"GET",data:a.data,dataType:"json",cache:!1,success:function(e){if("#SKIP#"!==a.callback){if("#DEFAULT#"===a.callback)return window.console.log("Respons from:'"+t.url+"':"),window.console.log("inputData: "+JSON.stringify(a.data)),void window.console.log("responsData: "+JSON.stringify(e));gen.isSet(e.meta.error)&&parseInt(e.meta.error,10)<0&&(window.console.error("Request to '"+t.url+"' returned an error, "),window.console.error("input :"+JSON.stringify(a.data)),window.console.log("responsData: "+JSON.stringify(e))),e.inputData=a.data,gen.runFunction(a.callback.trim(),e)}},error:function(e){window.console.error("Ajax request to '"+t.url+"' failed, input:"),window.console.error(JSON.stringify(a.data)),window.console.error("Debug info:"),window.console.error(e.responseText)}})},this.post=function(t){t.data.hasOwnProperty("me")&&delete t.data.me,t.data.url=t.url;var a={data:gen.setDefault(t.data,{}),callback:gen.setDefault(t.callback,"#NONE#")};$.ajax({url:"front.php",type:"POST",data:a.data,dataType:"json",cache:!1,success:function(e){"#NONE#"!==a.callback&&(gen.isSet(e.meta.error)&&parseInt(e.meta.error,10)<0&&(window.console.error("Request to '"+t.url+"' returned an error, "),window.console.error("input :"+JSON.stringify(a.data)),window.console.log("responsData: "+JSON.stringify(e))),e.inputData=a.data,gen.runFunction(a.callback.trim(),e))},error:function(e){window.console.error("Ajax request to '"+t.url+"' failed, input:"),window.console.error(JSON.stringify(a.data)),window.console.error("Debug info:"),window.console.error(e.responseText)}})},this}};$(document).ready(function(){$("#NE, #SW").bind("mousedown",dragg.start),$("#NE, #SW").bind("touchstart",dragg.start),$(document).bind("mouseup",dragg.stop),$(document).bind("touchend",dragg.stop)});var dragg={tip:null,start:function(t){t=t||window.event;{var a=document.getElementById("canvas").getBoundingClientRect(),e=(a.top,a.left,a.bottom,a.right,document.getElementById("area"));e.getBoundingClientRect()}e.style.margin=0,e.style.width="auto",e.style.height="auto",dragg.tip=$(this).attr("id"),$(document).bind("mousemove",dragg.move)},stop:function(){$(document).unbind("mousemove",dragg.move);document.getElementById("area")},move:function(t){t=t||window.event;var a=dragg.tip,e=document.getElementById("canvas").getBoundingClientRect(),o=document.getElementById("area"),n=o.getBoundingClientRect(),r=t.clientX-e.left,i=t.clientY-e.top,s="NE"==a?n.left-e.left+24:2,l="NE"==a?e.right-e.left:n.right-e.left-24,c="NE"==a?2:n.top-e.top+24,d="NE"==a?n.bottom-e.top-24:e.bottom-e.top-2;r=s>r?s:r,i=c>i?c:i,r=r>l?l:r,i=i>d?d:i;var u=map.getBounds(),v=u.getNorthEast(),f=u.getSouthWest(),g=e.right-e.left,p=e.bottom-e.top,h=f.lat()+r*(v.lat()-f.lat())/g,m=v.lng()+i*(f.lng()-v.lng())/p;if("NE"==a){var _=e.right-e.left-r;o.style.right=_+"px",o.style.top=i+"px",$("#NE_LAT").val(h),$("#NE_LNG").val(m)}else{var w=e.bottom-e.top-i;o.style.left=r+"px",o.style.bottom=w+"px",$("#SW_LAT").val(h),$("#SW_LNG").val(m)}}};$(document).ready(function(){$(document).on("click",'[href*="ajax/"]',function(t){t.preventDefault();var a=$(this).attr("href").split("/"),e="requests."+a.pop();gen.runFunction(e,$(this))}),$(document).on("click",'[data-sa*="ajax:"]',function(t){t.preventDefault();var a=sa.dataSA($(this).attr("data-sa"));gen.runFunction(a.ajax,$(this))})});var requests={imagesize:function(t){var a=new gen.ajax(""),e=t.hasClass("lr")?"lr":"normal";a.post({url:t.attr("href"),data:{status:e},callback:"requests.imagesize_callback"})},imagesize_callback:function(t){"lr"===t.status?$("#btn-imagsize").addClass("lr"):$("#btn-imagsize").removeClass("lr");var a=$("#btn-imagsize").attr("title");$("#btn-imagsize").attr("title",$("#btn-imagsize").attr("data-title")),$("#btn-imagsize").attr("data-title",a)},device:function(t){var a=new gen.ajax(""),e=t.hasClass("mobile")?"mobile":"desktop";a.post({url:t.attr("href"),data:{status:e},callback:"requests.device_callback"})},device_callback:function(t){window.console.log("calback"),window.console.log(JSON.stringify(t)),"mobile"===t.status?$("#btn-device").addClass("mobile"):$("#btn-device").removeClass("mobile");var a=$("#btn-device").attr("title");$("#btn-device").attr("title",$("#btn-device").attr("data-title")),$("#btn-device").attr("data-title",a),$('[data-sa*="show:device;"]').toggleClass("hide")}};$(document).ready(function(){ce.bind()});var ce={bind:function(){ce.radio.bind(),ce.check.bind()},data:function(t){for(var a=t.split(";"),e={},o=0;o<a.length;++o){var n=a[o].split(":");e[n[0]]=n[1]}return e},radio:{bind:function(){$(document).on("click taphold",".ce-radio",function(){var t=ce.data($(this).attr("data-ce"));$(this).hasClass("no-default")&&$(this).hasClass("checked")?$(this).removeClass("checked"):($('[data-ce*="name:'+t.name+';"]').removeClass("checked"),$(this).addClass("checked"))})},val:function(t){if($radioChecked=$('[data-ce*="name:'+t+';"].checked'),0==$radioChecked.size())return null;var a=ce.data($radioChecked.attr("data-ce"));return a.value}},check:{bind:function(){$(document).on("click",".ce-check",function(){$(this).toggleClass("checked")}),$(document).on("taphold",".ce-check",function(){$(this).toggleClass("checked")})},val:function(t){$checked=$('[data-ce*="name:'+t+';"].checked');var a=new Array;return $($checked).each(function(){var t=ce.data($(this).attr("data-ce"));-1===a.indexOf(t.value)&&a.push(t.value)}),a}}};$(document).ready(function(){$(document).on("submit",'form[data-sa*="submit:off;"]',function(t){t.preventDefault()}),$(document).on("click",'[data-sa*="onClick:"]',function(t){t.preventDefault();var a=sa.dataSA($(this).attr("data-sa"));a.me=$(this),gen.runFunction(a.onClick,a)}),$(document).on("change",'[data-sa*="onChange:"]',function(){var t=sa.dataSA($(this).attr("data-sa"));t.me=$(this),gen.runFunction(t.onChange,t)})});var sa={data:function(t){return sa.dataSA(t)},dataSA:function(t){for(var a=t.split(";"),e={},o=0;o<a.length;++o){var n=a[o].split(":");e[n[0]]=n[1]}return e},getFieldsByGroup:function(t){var a={},t=$('[data-sa*="group:'+t+'"]');return 0==t.size()?a:($(t).each(function(){var t=fe.dataSA($(this).attr("data-sa"));t.hasOwnProperty("data-field")&&(a[t["data-field"]]=fe.getValue($(this)))}),a)},getValue:function(t){var a=$(t).attr("type"),e=fe.dataSA($(t).attr("data-sa"));switch(e.hasOwnProperty("type")&&(a=e.type),a){case"radio":var o=$(t).attr("name");return $('[name="'+o+'"]').filter('[checked="checked"]').val();case"html":return $(t).html();default:return $(t).val()}},checkOnPattern:function(t){if(1!==$(t).filter("[pattern]").size())return!0;if(""==$(t).val())return!0;$(t).removeClass("pass").removeClass("fail");var a=$(t).attr("pattern"),e=new RegExp(a);return $(t).val().match(e)?($(t).addClass("pass"),!0):($(t).addClass("fail"),!1)},checkAllRequired:function(t){var a=!0;return $('[data-sa*="group:'+t+'"]').filter(".required").each(function(){$(this).removeClass("pass"),$(this).removeClass("fail"),""==$(this).val()?($(this).addClass("fail"),a=!1):fe.checkOnPattern(this)?$(this).addClass("pass"):($(this).addClass("fail"),a=!1)}),a}};$(document).ready(function(){$(document).on("click","#btn-showmenu",ui.show_menu),$(document).on("click",' a[data-link-id*="reference"], a[data-link-id*="note"]',ui.show_popup),$(document).on("click",'img[data-image-id][src$=".png"]',ui.load_img_hr),$(document).on("click",'[data-sa*="action:ui.toggle_article;id:"]',ui.toggle_article),$(document).on("click","#btn-settings",ui.toggle_settings)});var ui={show_menu:function(t){t.preventDefault();var a=$(this).attr("title");$(this).attr("title",$(this).attr("data-title")),$(this).attr("data-title",a),$(this).toggleClass("close"),$("#menu-header").toggleClass("show")},show_popup:function(t){t.preventDefault(),alert($(this).attr("title"))},load_img_hr:function(){window.console.log("img");var t=$(this).attr("src");window.console.log(t),t=t.replace(".png",".jpeg"),window.console.log("to:"+t),$(this).attr("src",t),$(this).removeAttr("title")},toggle_article:function(){var t=sa.data($(this).attr("data-sa")),a=t.id;$(this).toggleClass("open"),$('[data-sa="hide_on:'+a+';"]').toggleClass("hide")},toggle_settings:function(t){t.preventDefault(),$('[data-sa="settings"]').slideToggle(tan)}};$(document).ready(function(){$(document).on("click",'[data-ce*="type:radio"], [data-ce*="type:check"]',function(){var t=$(this).parents("[data-observation-id]"),a=observation.registrate(t);if(0!=a){var e=a.val(),o=$('[data-observation-id="'+a.id+'"]').find('[data-ce="value:'+e+'"]');$(this).hasClass("checked")?o.addClass("checked"):o.removeClass("checked"),observation.update(a)}}),$(document).on("keyup",'input[data-observation-id][type="text"]',function(){var t=observation.registrate($(this));if(0!=t){var a=$(this).val();$('input[data-observation-id="'+t.id+'"][type="text"]').not(this).val(a)}}),$(document).on("change",'input[data-observation-id][type="text"]',function(){var t=observation.registrate($(this));if(0!=t){var a=observation.val();$('input[data-observation-id="'+t.id+'"][type="text"]').not(this).val(a),observation.update(t)}})});var observation={registrate:function(t){if(this.obj=t,1!==this.obj.filter("[data-type]").size())return window.console.error("observation.registrate failed: no data-type attribute."),!1;var a=["value","radio","check"];return this.type=this.obj.attr("data-type").toLowerCase().trim(),-1===a.indexOf(this.type)?(window.console.error("observation.registrate failed: no valid data-type attribute."),!1):(this.id=parseInt(this.obj.attr("data-observation-id"),10),this.id<1||isNaN(this.id)?(window.console.error("observation.registrate failed: no valid data-observation-id attribute."),!1):("value"===this.type.toString()&&(this.default_value="null"!=this.obj.attr("data-default").toLowerCase()?parseFloat(this.obj.attr("data-default")):null,this.min="null"!=this.obj.attr("data-min").toLowerCase()?parseFloat(this.obj.attr("data-min")):null,this.max="null"!=this.obj.attr("data-max").toLowerCase()?parseFloat(this.obj.attr("data-max")):null),this.val=function(){var t="#NA",a=this.type.toString(),e="observation-"+this.id.toString();switch(a){case"radio":t=ce.radio.val(e);break;case"check":t=ce.check.val(e);break;case"value":t="null"!=this.obj.val()?parseFloat(this.obj.val()):null,t=isNaN(t)?null:t,null!==this.default_value&&null==t&&(t=this.default_value,this.obj.val(t)),null!==this.min&&null!==t&&(t=t<this.min?this.min:t,this.obj.val(t)),null!==this.max&&null!==t&&(t=t>this.max?this.max:t,this.obj.val(t))}return t},this))},reset:function(){var t=window.confirm("Weet u zeker dat u alle waarnemingen wilt wissen?");if(0!=t){if(1!=$("html[data-sa]").eq(0).size())return void window.console.error("no html data-sa");var a=sa.dataSA($("html").eq(0).attr("data-sa")),e=a.application+"/observation/reset",o=new gen.ajax(""),n=window.location.href.split("#");o.post({url:e,data:{redirect:n[0]},callback:"observation.reset_callback"})}},reset_callback:function(t){"on"==debug&&window.console.info("observation.reset_callback"),"#NA"!=t.redirect&&(window.location.href=t.redirect)},update:function(t){if(1!=$("html[data-sa]").eq(0).size())return void window.console.error("no html data-sa");var a=t.val();if("#NA"==a)return void window.console.error("no value");var e=t.id,o=sa.dataSA($("html").eq(0).attr("data-sa")),n=o.application+"/observation/update",r=new gen.ajax("");r.post({url:n,data:{ID:e,val:a}})}};$(document).ready(function(){var t='.calculation [data_rule_show] .observation [data-ce*="type:"],  ';t+='.calculation [data_rule_msg]  .observation [data-ce*="type:"],  ',t+='.calculation [data_rule_info] .observation [data-ce*="type:"],  ',t+='.calculation [data_rule_calc] .observation [data-ce*="type:"],  ',t+='.calculation [data_rule_report] .observation [data-ce*="type:"] ',$(document).on("click",t,calculation.listener),$(document).on("taphold",t,calculation.listener);var t='.calculation [data_rule_show] .observation [type="text"],  ';t+='.calculation [data_rule_msg]  .observation [type="text"],  ',t+='.calculation [data_rule_info] .observation [type="text"],  ',t+='.calculation [data_rule_calc] .observation [type="text"],  ',t+='.calculation [data_rule_report] .observation [type="text"] ',$(document).on("change",t,calculation.listener);var t='.calculation [data_rule_show] .observation [data-ce*="type:"],   ';t+='.calculation [data_rule_msg]  .observation [data-ce*="type:"],   ',t+='.calculation [data_rule_info] .observation [data-ce*="type:"],   ',t+='.calculation [data_rule_calc] .observation [data-ce*="type:"],   ',t+='.calculation [data_rule_report] .observation [data-ce*="type:"], ',t+='.calculation [data_rule_show] .observation [type="text"],        ',t+='.calculation [data_rule_msg]  .observation [type="text"],        ',t+='.calculation [data_rule_info] .observation [type="text"],        ',t+='.calculation [data_rule_calc] .observation [type="text"],        ',t+='.calculation [data_rule_report] .observation [type="text"]       ',$(t).each(function(){var t=$(this).parents(".observation"),a=calculation.take_actions(t,!1);calculation.toggle_btn_open_report(a)});var t='.calculation .observation [data-ce*="type:"]';$(document).on("click",t,calculation.listener_update_result),$(document).on("taphold",t,calculation.listener_update_result);var t='.calculation .observation [type="text"]';$(document).on("change",t,calculation.listener_update_result)});var calculation={listener:function(){var t=$(this).parents(".input"),a=t.find("[data-observation-id]"),e=calculation.take_actions(a,!1);calculation.toggle_btn_open_report(e)},take_actions:function(t,a){var e=calculation.interpreter(t);if(e.is_available!==!1){var o=e.calculation,n=e.input,r=$(".input").index(n);$(".input").slice(r+1).filter(".conditional").addClass("ui-closed");var i=!1,s=n.find(".msg");s.addClass("ui-closed"),s.find("[data-action]").addClass("ui-closed");var l=!1,c=n.find(".info");c.addClass("ui-closed"),c.find("[data-action]").addClass("ui-closed");var d=!1,u=n.find(".calc");u.addClass("ui-closed"),u.find("[data-action]").addClass("ui-closed");var v=calculation.get_actions(t),f=[];for(var g in v)for(var p in v[g]){var h=v[g][p],m=e.execute(h);if("show"===g&&(m=t.parents(".input").hasClass("ui-closed")?!1:m),1==m){if("msg"==g&&(i=!0,s.find('[data-action="'+p+'"]').removeClass("ui-closed")),"info"==g&&(l=!0,c.find('[data-action="'+p+'"]').removeClass("ui-closed")),"calc"==g&&(d=!0,u.find('[data-action="'+p+'"]').removeClass("ui-closed")),"show"==g){var _=o.find("#input-"+p);_.removeClass("ui-closed"),_.removeClass("conditional"),f.push(_.find("[data-observation-id]"))}"report"==g&&(a=!0)}else if("show"==g){var _=o.find("#input-"+p);_.addClass("ui-closed"),_.addClass("conditional"),f.push(_.find("[data-observation-id]"))}}i&&s.removeClass("ui-closed");for(var w=0;w<f.length;w++)a=calculation.take_actions(f[w],a);return a}},listener_update_result:function(){$("html").attr("data-time-stamp",Date.now()),$("#score, #stroke_top").css("opacity","0.3"),$("#score, #stroke_top").find("span").css("background-color","#FFF");var t={};t.time_stamp=$("html").attr("data-time-stamp"),t.id=$("[data-calculation-id]").attr("data-calculation-id");var a=new gen.ajax(""),e=sa.dataSA($("html").eq(0).attr("data-sa")),o="VBNE"==e.application?"ajax/update_result":e.application+"/ajax/update_result";a.get({url:o,data:t,callback:"calculation.update_result"})},update_result:function(t){if("on"==debug&&(window.console.info("fe.favorite_added"),window.console.log(JSON.stringify(t))),!(parseInt(t.meta.error,10)<0)){var a=parseInt($("html").attr("data-time-stamp"),10),e=parseInt(t.time_stamp,10);return window.console.info(e>=a),e>=a?(window.console.info("UPADATE"),window.console.log(t.result),$("#score").html(t.html),$("#stroke_top").html(t.html_stroke_top),void $("#score, #stroke_top").css("opacity","1")):void 0}},toggle_btn_open_report:function(t){$(".calculation [data_rule_report]").size()>0&&(t?$("#open-report").removeClass("ui-closed"):$("#open-report").addClass("ui-closed"))},get_actions:function(t){var a={};1==t.parents("[data_rule_show]").size()&&(a.show=t.parents("[data_rule_show]").attr("data_rule_show")),1==t.parents("[data_rule_msg]").size()&&(a.msg=t.parents("[data_rule_msg]").attr("data_rule_msg")),1==t.parents("[data_rule_info]").size()&&(a.info=t.parents("[data_rule_info]").attr("data_rule_info")),1==t.parents("[data_rule_calc]").size()&&(a.calc=t.parents("[data_rule_calc]").attr("data_rule_calc")),1==t.parents("[data_rule_report]").size()&&(a.report=t.parents("[data_rule_report]").attr("data_rule_report"));var e={};for(var o in a){e.hasOwnProperty(o)||(e[o]={});for(var n=a[o].trim().split("|"),r=0;r<n.length;r++){var i=n[r].trim().split(":");2==i.length&&(e[o][i[1]]=i[0])}}return e},interpreter:function(t){return this.is_available=!1,this.valid_types=["value","radio","check"],this.valid_rules={},this.valid_rules.value=["EQ","NE","LT","GT","LE","GE","BETWEEN","IS_NULL","IS_NOT_NULL","AND","OR"],this.valid_rules.radio=["IN","NOT","AND","OR","IS_NULL","IS_NOT_NULL"],this.valid_rules.check=["IN","ALL","NONE","CHECK","AND","OR"],this.rules_without_param=["IS_NULL","IS_NOT_NULL"],this.type=null,this.val="#NA",this.check_nb=null,this.input=null,this.calculation=null,this.construct=function(t){this.calculation=t.parents(".calculation"),this.input=t.parents(".input");var a=this.input.find("[data-observation-id]");this.observation_object=observation.registrate(a);var e=this.observation_object.type,o=this.valid_types.indexOf(e);if(-1==o)return window.console.error("calculation.interpreter: type incorrect"),this;this.type=this.valid_types[o];var n=this.observation_object.val();if("#NA"==n)return window.console.error("calculation.interpreter: incorrect value"),this;if("radio"==this.type&&(n=null!=n?parseInt(n,10):null,n=[n]),"check"==this.type){if(n=this.to_integer(n),!n)return window.console.error("calculation.interpreter: incorrect value"),this;this.check_nb=this.input.find('[data-ce*="type:check;"]').size()}return"value"==this.type&&null!=n&&(n=this.to_float(n),"#NA"==n)?(window.console.error("calculation.interpreter: incorrect value"),this):(this.val=n,this.is_available=!0,this)},this.execute=function(t){var a=t.indexOf("(");if(-1==a)return"#NA";var e=t.substring(0,a).trim().toUpperCase();if(-1==this.valid_rules[this.type].indexOf(e))return"#NA";var o=null;if(-1==this.rules_without_param.indexOf(e)){a++;var n=t.length-1;if(a==n)return"#NA";var r=t.substring(a,n).trim();-1!=r.indexOf(");")?(r=r.replace(/\);/g,")<split here/>"),o=r.split("<split here/>")):o=r.split(";")}var i=this.val;if("#NA"==i)return"#NA";var s="#NA";switch(e){case"EQ":var l=this.to_float(o[0]);if("#NA"==l)break;if(null==i){s=!1;break}s=i==l;break;case"NE":var l=this.to_float(o[0]);if("#NA"==l)break;if(null==i){s=!0;break}s=i!=l;break;case"GE":var l=this.to_float(o[0]);if("#NA"==l)break;if(null==i){s=!1;break}s=i>=l;break;case"LE":var l=this.to_float(o[0]);if("#NA"==l)break;if(null==i){s=!1;break}s=l>=i;break;case"GT":var l=this.to_float(o[0]);if("#NA"==l)break;if(null==i){s=!1;break}s=i>l;break;case"LT":var l=this.to_float(o[0]);if("#NA"==l)break;if(null==i){s=!1;break}s=l>i;break;case"BETWEEN":if(o.length<4)break;var c=o[0].trim().toUpperCase(),d=o[2].trim().toUpperCase();if(-1==["GT","GE"].indexOf(c))break;if(-1==["LT","LE"].indexOf(d))break;var u=this.to_float(o[1]),v=this.to_float(o[3]);if("#NA"==u||"#NA"==v)break;if(null==i){s=!1;break}s="GT"==c?i>u:i>=u,s="LT"==d?s&&v>i:s&&v>=i;break;case"IS_NULL":i="radio"==this.type?i[0]:i,s=null==i;break;case"IS_NOT_NULL":i="radio"==this.type?i[0]:i,s=null!=i;break;case"IN":if(o=this.to_integer(o),o===!1)break;var f=0,g=i.length;for(s=!1;g>f&&!s;)o.indexOf(i[f])>-1&&(s=!0),f++;break;case"NOT":if(o=this.to_integer(o),o===!1)break;var f=0,g=o.length;s=!0;do-1==i.indexOf(o[f])&&(s=!1),f++;while(g>f&&s);break;case"ALL":if(o=this.to_integer(o),o===!1)break;var f=0,g=o.length;s=!0;do-1==i.indexOf(o[f])&&(s=!1),f++;while(g>f&&s);break;case"NONE":if(o=this.to_integer(o),o===!1)break;var f=0,g=i.length;for(s=!0;g>f&&s;)o.indexOf(i[f])>-1&&(s=!1),f++;break;case"CHECK":var p=o[0].trim();if(p=0==p.length||"*"==p||"ALL"==p.toUpperCase()||0==p?0==p.length||0==p?0:this.check_nb:$.isNumeric(p)?parseInt(p,10):"#NA","#NA"==p)break;var h="EQ";if(o.length>1){var m=o[1].trim().toUpperCase();h=["NE","GT","GE","LT","LE"].indexOf(m)>-1?m:"EQ"}var _=this.input.find('[data-ce*="type:check;"].checked').size();switch(h){case"NE":s=_!=p;break;case"GT":s=_>p;break;case"GE":s=_>=p;break;case"LT":s=p>_;break;case"LE":s=p>=_;break;default:s=_==p}break;case"AND":var f=0,g=o.length;for(s=!0;g>f&&"#NA"!==s;)s=s&&this.execute(o[f]),f++;break;case"OR":var f=0,g=o.length;for(s=!1;g>f&&"#NA"!==s;)s=s||this.execute(o[f]),f++}return s},this.to_integer=function(t){for(var a=0,e=!0,o=t.length;o>a&&$.isNumeric(t[a])&&e;){var n=parseInt(t[a],10);n==t[a]?(t[a]=n,a++):e=!1}return a==o?t:!1},this.to_float=function(t){return $.isNumeric(t)?parseFloat(t):t.indexOf(",")>-1?parseFloat(t.replace(/,/,".")):"#NA"},this.construct(t),this}};$(document).ready(function(){$(document).on("click",'[data-fe*="add_to_favorite:"]',fe.add_to_favorite),$(document).on("click",'[data-fe="remove_all_favorites"]',fe.remove_all_favorites),$(document).on("click",'[data-fe*="remove_from_favorite:"]',fe.remove_from_favorite),$(document).on("click","#save_favorites",fe.save_favorites),$(document).on("change","#report_set",fe.change_favorites),$(document).on("click","#save_oberservation_set",fe.save_observation_set),$(document).on("change","#observation_set",fe.change_observation_set),$("input.date").size()>0&&$("input.date").datepicker({dateFormat:"yy-mm-dd"})});var fe={add_to_favorite:function(t){t.preventDefault(),t.stopPropagation();var a={},e=sa.data($(this).attr("data-fe"));a.ID=e.add_to_favorite;var o=new gen.ajax(""),n=sa.dataSA($("html").eq(0).attr("data-sa")),r="VBNE"==n.application?"ajax/favorite_add":n.application+"/ajax/favorite_add";o.post({url:r,data:a,callback:"fe.favorite_added"})},favorite_added:function(t){return"on"==debug&&(window.console.info("fe.favorite_added"),window.console.log(JSON.stringify(t))),t.meta.error<0?void("on"==debug&&window.console.log(JSON.stringify(t))):void $('[data-counter="favorites"]').text(t.count).removeClass("hide")},remove_all_favorites:function(t){t.preventDefault(),t.stopPropagation();var a={},e=sa.data($(this).attr("data-fe"));a.ID=e.add_to_favorite;var o=new gen.ajax(""),n=sa.dataSA($("html").eq(0).attr("data-sa")),r="VBNE"==n.application?"ajax/favorite_remove_all":n.application+"/ajax/favorite_remove_all";o.post({url:r,data:a,callback:"fe.favorite_all_removed"})},favorite_all_removed:function(t){return"on"==debug&&(window.console.info("fe.favorite_added"),window.console.log(JSON.stringify(t))),t.meta.error<0?void("on"==debug&&window.console.log(JSON.stringify(t))):($('[data-counter="favorites"]').text(0).addClass("hide"),void $("#container-favorites").remove())},remove_from_favorite:function(t){t.preventDefault(),t.stopPropagation();var a={},e=sa.data($(this).attr("data-fe"));a.ID=e.remove_from_favorite;var o=new gen.ajax(""),n=sa.dataSA($("html").eq(0).attr("data-sa")),r="VBNE"==n.application?"ajax/favorite_remove":n.application+"/ajax/favorite_remove";o.post({url:r,data:a,callback:"fe.favorite_removed"})},favorite_removed:function(t){return"on"==debug&&(window.console.info("fe.favorite_removed"),window.console.log(JSON.stringify(t))),t.meta.error<0?void("on"==debug&&window.console.log(JSON.stringify(t))):void location.reload()},save_favorites:function(t){t.preventDefault(),window.console.info("save_favorites");var a=sa.dataSA($("html").eq(0).attr("data-sa"));if("VBNE"!=a.application){var e=$('[data-sa*="current_selection:"]'),o=sa.data(e.attr("data-sa")),n=parseInt(o.current_selection,10),r={};r.ID=n;var i=-1==n?"":e.text();r.name=window.prompt("Geef een naam of voor deze set artikelen",i),r.ID=r.name!=i?-1:r.ID;var s=new gen.ajax(""),l=a.application+"/ajax/report_set_save";s.post({url:l,data:r,callback:"fe.favorites_saved"})}},favorites_saved:function(t){return t.meta.error<0?("on"==debug&&window.console.log(JSON.stringify(t)),void alert(t.meta.msg)):void location.reload()},change_favorites:function(){window.console.info("change_favorites");var t=sa.dataSA($("html").eq(0).attr("data-sa"));if("VBNE"!=t.application){var a=$("#report_set"),e=parseInt(a.val(),10),o=e>0?a.find('option[value="'+e+'"]').text():"";if(window.console.log("ID: "+e),window.console.log("name: "+o),!(1>e)){var n=$('[data-sa*="current_selection:"]'),r=sa.data(n.attr("data-sa"));if(e!=parseInt(r.current_selection,10)&&window.confirm('Bij een klik op "OK" wordt de huidige selectie overschreven.')){var i={};i.ID=e;var s=new gen.ajax(""),l=t.application+"/ajax/report_set_change";return void s.post({url:l,data:i,callback:"fe.favorites_changed"})}}}},favorites_changed:function(t){return t.meta.error<0?void("on"==debug&&window.console.log(JSON.stringify(t))):void location.reload()},save_observation_set:function(t){t.preventDefault(),window.console.info("save_observation_set");var a=sa.dataSA($("html").eq(0).attr("data-sa"));if("VBNE"!=a.application){var e=$('[data-sa*="current_selection:"]'),o=sa.data(e.attr("data-sa")),n=parseInt(o.current_selection,10),r={};r.ID=n;var i=-1==n?"":e.text();r.name=window.prompt("Geef een naam of voor deze set observaties",i),r.ID=r.name!=i?-1:r.ID;var s=new gen.ajax(""),l=a.application+"/ajax/observation_set_save";s.post({url:l,data:r,callback:"fe.obsevation_set_saved"})}},obsevation_set_saved:function(t){return window.console.info("obsevation_set_saved"),t.meta.error<0?("on"==debug&&window.console.log(JSON.stringify(t)),void alert(t.meta.msg)):void location.reload()},change_observation_set:function(){window.console.info("change_observation_set");var t=sa.dataSA($("html").eq(0).attr("data-sa"));if("VBNE"!=t.application){var a=$("#observation_set"),e=parseInt(a.val(),10),o=e>0?a.find('option[value="'+e+'"]').text():"";if(window.console.log("ID: "+e),window.console.log("name: "+o),!(1>e)){var n=$('[data-sa*="current_selection:"]'),r=sa.data(n.attr("data-sa"));if(e!=parseInt(r.current_selection,10)&&window.confirm('Bij een klik op "OK" wordt de huidige set observaties overschreven.')){var i={};i.ID=e;var s=new gen.ajax(""),l=t.application+"/ajax/observation_set_change";return void s.post({url:l,data:i,callback:"fe.observation_set_changed"})}}}},observation_set_changed:function(t){return t.meta.error<0?void("on"==debug&&window.console.log(JSON.stringify(t))):void location.reload()},toggle_view:function(t){window.console.info("fe.toggle_view");var a=t.me;a.toggleClass("open").toggleClass("closed");var e=t.label;window.console.info("label: "+e),window.console.info($('[data-sa="'+e+'"]').size());var o=$('[data-sa="'+e+'"]');o.each(function(){$(this).hasClass("hide")?$(this).slideUp(0,function(){$(this).removeClass("hide"),$(this).slideDown(tan)}):$(this).slideToggle(tan)})}};$(document).ready(function(){$(document).on("click","#new-account",user.new_account),$(document).on("click","#password-reset",user.password_reset),$(document).on("click",'[data-ce*="name:showName;"]',user.toggle_show_name),$(document).on("taphold",'[data-ce*="name:showName;"]',user.toggle_show_name),$(document).on("click",'[data-ce*="name:shareObservations;"]',user.toggle_share_observations),$(document).on("taphold",'[data-ce*="name:shareObservations;"]',user.toggle_share_observations),$(document).on("click","#delete",user.delete_account),$(document).on("submit",'[action="save_my_observation"]',user.save_my_observation),$(document).on("submit",'[action="save_my_report"]',user.save_my_report),$(document).on("click",'[data-sa*="remove"]',user.remove)});var user={my_account_save_callback:function(t){window.console.info("user.my_account_save_callback"),window.console.info(JSON.stringify(t));var a=$("#"+t.inputData.form_id);window.console.info(a.size()),t.meta.error<0?(a.find(".msg").addClass("warning"),t.hasOwnProperty("field_warning")&&a.find('[name="'+t.field_warning+'"]').addClass("warning")):(form.data.remove(a),a.find(".changed").removeClass("changed")),a.find(".msg").text(t.meta.msg),a.find(".msg").slideDown(tan)},new_account:function(t){t.preventDefault(),window.console.info("new-account"),$("#login").attr("action","registatie"),$("#login").trigger("submit")
},delete_account:function(t){t.preventDefault(),window.console.info("delete");var a=confirm("Verwijderen van het account kan niet ongedaan worden, door op OK te klikken vewijdert u uw account definitief.");if(0!=a){var e=$(this).attr("href");$("#my-account-ar").attr("action",e),$("#my-account-ar").trigger("submit")}},password_reset:function(t){t.preventDefault(),window.console.info("password-reset"),$("#login").attr("action","password_reset_request"),$("#login").trigger("submit")},toggle_show_name:function(){var t=$(this).hasClass("checked")?1:-1;$("#showName").val(t)},toggle_share_observations:function(){var t=$(this).hasClass("checked")?1:-1;$("#shareObservations").val(t)},save_my_observation:function(t){t.preventDefault();var a={};a.name=$("#name").val(),window.console.info("data.name: "+a.name),a.ID=$("#ID").val(),window.console.info("data.ID: "+a.ID),a.date=$("#date").val(),window.console.info("data.date: "+a.date);var e=new Array;$('[data-ce*="name:user;"].checked').size()>0&&($('[data-ce*="name:user;"].checked').each(function(){var t=sa.data($(this).attr("data-ce"));e.push(t.ID)}),a.viewers=JSON.stringify(e),window.console.info("data.viewers: "+a.viewers));var o=new gen.ajax(""),n=sa.dataSA($("html").eq(0).attr("data-sa"));if("VBNE"==n.application)return void alert("Deze functie kan niet worden uitgevoerd.");var r=n.application+"/ajax/observation_set_save_meta";o.post({url:r,data:a,callback:"user.observation_set_save_meta_callback"})},observation_set_save_meta_callback:function(t){if(parseInt(t.meta.error,10)<0)return"on"==debug&&window.console.error(JSON.stringify(t)),void $("#msg").html(t.meta.msg).addClass("warning");var a=sa.dataSA($("html").attr("data-sa"));url=a.path+a.application+"/my_observations",location.assign(url)},save_my_report:function(t){t.preventDefault();var a={};a.name=$("#name").val(),a.ID=$("#ID").val();var e=new Array;$('[data-ce*="name:user;"].checked').size()>0&&($('[data-ce*="name:user;"].checked').each(function(){var t=sa.data($(this).attr("data-ce"));e.push(t.ID)}),a.viewers=JSON.stringify(e),window.console.info("data.viewers: "+a.viewers));var o=new gen.ajax(""),n=sa.dataSA($("html").eq(0).attr("data-sa"));if("VBNE"==n.application)return void alert("Deze functie kan niet worden uitgevoerd.");var r=n.application+"/ajax/report_set_save_meta";o.post({url:r,data:a,callback:"user.report_set_save_meta_callback"})},report_set_save_meta_callback:function(t){if(parseInt(t.meta.error,10)<0)return"on"==debug&&window.console.error(JSON.stringify(t)),void $("#msg").html(t.meta.msg).addClass("warning");var a=sa.dataSA($("html").attr("data-sa"));url=a.path+a.application+"/my_reports",location.assign(url)},remove:function(t){t.preventDefault();var a=confirm("Verwijderen kan niet ongedaan worden, door op OK te klikken vewijdert u definitief.");if(0!=a){var e={},o=sa.data($(this).attr("data-sa"));e.ID=o.id,e.ext=o.remove;var n=new gen.ajax(""),r=sa.dataSA($("html").eq(0).attr("data-sa")),i=r.application+"/ajax/remove_set";n.post({url:i,data:e,callback:"user.remove_callback"})}},remove_callback:function(t){if(parseInt(t.meta.error,10)<0)return"on"==debug&&window.console.error(JSON.stringify(t)),void $("#msg").html(t.meta.msg).addClass("warning");var a=sa.dataSA($("html").attr("data-sa"));url=a.path+a.application+"/"+t.page,location.assign(url)}};$(document).ready(function(){$(document).on("click",'[data-sa*="geo.toggle_area"]',geo.toggle_area),$(document).on("submit",'form[data-sa*="submit:get_location"]',geo.save_location),$(document).on("click","#btn-location-ne",geo.get_location_ne),$(document).on("click","#btn-location-sw",geo.get_location_sw)});var geo={active_tip:null,init:function(){var t=parseFloat($("#centre_LAT").val()),a=parseFloat($("#centre_LNG").val()),e=parseFloat($("#zoom").val());map=new google.maps.Map(document.getElementById("map"),{center:{lat:t,lng:a},fullscreenControl:!1,zoom:e});var o=parseFloat($("#NE_LAT").val());if(!isNaN(o)){var n=parseFloat($("#NE_LNG").val());if(!isNaN(n)){var r=parseFloat($("#SW_LAT").val());if(!isNaN(r)){var i=parseFloat($("#SW_LNG").val());if(!isNaN(i)){var s=new google.maps.LatLng(o,n),l=new google.maps.LatLng(r,i),c=new google.maps.LatLngBounds(l,s);s=c.getNorthEast(),l=c.getSouthWest(),map.fitBounds(c),map.panToBounds(c)}}}}},toggle_area:function(t){t.preventDefault(),$("#msg").html("").removeClass("warning"),$("#geo_save, #area").toggleClass("hide");var a=map.getBounds(),e=a.getNorthEast(),o=a.getSouthWest();window.console.info("map NE:"),window.console.log("lat: "+e.lat()),window.console.log("lng: "+e.lng()),window.console.info("map SW:"),window.console.log("lat: "+o.lat()),window.console.log("lng: "+o.lng()),window.console.info("area NE:"),window.console.log("lat: "+$("#NE_LAT").val()),window.console.log("lng: "+$("#NE_LNG").val()),window.console.info("area SW:"),window.console.log("lat: "+$("#SW_LAT").val()),window.console.log("lng: "+$("#SW_LNG").val());var n=e.lat()-o.lat(),r=e.lng()-o.lng();window.console.info("map span_lat: "+n),window.console.info("map span_lng: "+r);var i=100*($("#NE_LNG").val()-o.lng())/r,s=100*($("#NE_LAT").val()-o.lat())/n,l=100*($("#SW_LNG").val()-o.lng())/r,c=100*($("#SW_LAT").val()-o.lat())/n;window.console.info("area-NE:"),window.console.log("x: "+i+"%"),window.console.log("y: "+s+"%"),window.console.info("area-SW:"),window.console.log("x: "+l+"%"),window.console.log("y: "+c+"%");var d=100*($("#SW_LNG").val()-o.lng())/n,u=100*(e.lat()-$("#NE_LAT").val())/r,v=100*(e.lng()-$("#NE_LNG").val())/n,f=100-100*($("#SW_LAT").val()-o.lat())/r;window.console.info("area:"),window.console.log("top: "+u+"%"),window.console.log("left: "+d+"%"),window.console.log("bottom: "+f+"%"),window.console.log("right: "+v+"%");var g=$(this).text(),p=$(this).attr("title");$(this).text($(this).attr("data-txt")),$(this).attr("data-txt",g),$(this).attr("title",$(this).attr("data-title")),$(this).attr("data-title",p)},save_location:function(t){t.preventDefault(),$("#msg").html("").removeClass("warning");var a=document.getElementById("canvas").getBoundingClientRect(),e=document.getElementById("area").getBoundingClientRect(),o=a.right-a.left,n=a.bottom-a.top,r=e.top-a.top,i=o-e.right,s=n-e.bottom,l=e.left,c=map.getBounds(),d=c.getNorthEast(),u=c.getSouthWest(),v={};v.ID=$("#ID").val(),v.NE_LAT=u.lat()+i*(d.lat()-u.lat())/o,v.NE_LNG=d.lng()+r*(u.lng()-d.lng())/n,v.SW_LAT=u.lat()+l*(d.lat()-u.lat())/o,v.SW_LNG=d.lng()+s*(u.lng()-d.lng())/n;var f=new gen.ajax(""),g=sa.dataSA($("html").attr("data-sa")),p=g.application+"/ajax/observation_set_save_meta";f.post({url:p,data:v,callback:"geo.location_saved"})},location_saved:function(t){if(parseInt(t.meta.error,10)<0)return"on"==debug&&window.console.error(JSON.stringify(t)),void $("#msg").html(t.meta.msg).addClass("warning");var a=sa.dataSA($("html").attr("data-sa"));url=a.path+a.application+"/my_observations?id="+t.ID,location.assign(url)},get_location_ne:function(t){return geo.active_tip="NE",geo.get_location(t)},get_location_sw:function(t){return geo.active_tip="SW",geo.get_location(t)},get_location:function(t){t.preventDefault();var a={enableHighAccuracy:!0,timeout:8e3,maximumAge:0};navigator.geolocation.getCurrentPosition(geo.get_location_success,geo.get_location_error,a)},get_location_success:function(t){var a=t.coords,e={};e.ID=$("#ID").val(),"NE"==geo.active_tip&&(e.NE_LAT=a.latitude,e.NE_LNG=a.longitude),"SW"==geo.active_tip&&(e.SW_LAT=a.latitude,e.SW_LNG=a.longitude);var o=new gen.ajax(""),n=sa.dataSA($("html").attr("data-sa")),r=n.application+"/ajax/observation_set_save_meta";o.post({url:r,data:e,callback:"geo.location_saved"})},get_location_error:function(t){$("#msg").html(t.message).addClass("warning")}},debug="off",show="off",no_redirect="on",tan=200;$(document).on("scroll",function(){var t=$("html").scrollTop();$("[data-pos][href]").each(function(){var a=$(this).attr("href")+"&pos="+t;$(this).attr("href",a)})});var pos=gen.getUrlParameter(window.location.href,"pos",0);window.scrollTo(0,pos);